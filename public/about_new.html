<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive 3D Welcome Animation</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        
        #three-container {
            width: 100vw;
            height: 100vh;
        }
        
        .back-link {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 0.75rem 1.5rem;
            background-color: rgba(34,197,94,0.8);
            color: white;
            font-weight: bold;
            border-radius: 0.5rem;
            text-decoration: none;
            z-index: 10;
            transition: 0.3s;
        }
        
        .back-link:hover {
            background-color: rgba(22,163,74,0.9);
        }
        
        .info-panel {
            position: absolute;
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 15px;
            border-radius: 8px;
            display: none;
            z-index: 1000;
            font-family: Arial, sans-serif;
            font-size: 14px;
            max-width: 200px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.5);
            border: 2px solid #ff6b35;
        }
        
        .info-panel a {
            color: #ff6b35;
            text-decoration: none;
            font-weight: bold;
        }
        
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 18px;
            z-index: 999;
        }
        
        #three-container canvas {
            transition: opacity 0.3s ease;
        }
    </style>
</head>
<body>
    <div id="three-container"></div>
    <div class="loading" id="loading">Loading 3D Animation...</div>
    <a href="index.html" class="back-link">‚Üê Back to Home</a>
    
    <!-- Three.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Font loader for text geometry -->
    <script src="https://threejs.org/examples/js/loaders/FontLoader.js"></script>
    <script src="https://threejs.org/examples/js/geometries/TextGeometry.js"></script>
    
    <script>
        console.log('Starting 3D Welcome Animation...');
        
        let scene, camera, renderer;
        let font;
        let welcomeText;
        let letterSpheres = [];
        let interactiveSpheres = [];
        let currentPhase = 1; // 1: Welcome text, 2: Letter transformation, 3: Vertical layout, 4: Interactive cards
        let phaseStartTime = 0;
        let animationClock = new THREE.Clock();
        const portfolioURL = 'https://thestrokes1.github.io/Portfolio-Cristian/';
        
        // Card data for final interactive phase
        const cardData = [
            { name: 'card1', title: 'Web Development', description: 'Modern websites & apps', image: 'üåê' },
            { name: 'card2', title: 'UI/UX Design', description: 'User interface design', image: 'üé®' },
            { name: 'card3', title: 'Mobile Apps', description: 'iOS & Android development', image: 'üì±' },
            { name: 'card4', title: 'Backend Systems', description: 'Server & database design', image: '‚öôÔ∏è' },
            { name: 'card5', title: '3D Graphics', description: 'Three.js & WebGL', image: 'üéØ' },
            { name: 'card6', title: 'AI Integration', description: 'Machine learning solutions', image: 'ü§ñ' },
            { name: 'card7', title: 'Portfolio', description: 'View all my projects', image: 'üíº' }
        ];
        
        function init() {
            console.log('Initializing 3D Welcome Animation...');
            
            const container = document.getElementById('three-container');
            const loading = document.getElementById('loading');
            
            if (!container) {
                console.error('Container not found!');
                return;
            }
            
            // Scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x111111);
            
            // Camera
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;
            
            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            container.appendChild(renderer.domElement);
            
            // Lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(1, 1, 1);
            scene.add(directionalLight);
            
            // Point light for glow effects
            const pointLight = new THREE.PointLight(0xff6b35, 1, 100);
            pointLight.position.set(0, 0, 5);
            scene.add(pointLight);
            
            // Load font and start animation
            const loader = new THREE.FontLoader();
            loader.load('https://threejs.org/examples/fonts/helvetiker_regular.typeface.json', function(font) {
                this.font = font;
                startWelcomeAnimation();
            }.bind(this));
            
            // Event listeners
            window.addEventListener('mousemove', onMouseMove);
            window.addEventListener('click', onClick);
            window.addEventListener('resize', onWindowResize);
            
            loading.style.display = 'none';
            animate();
        }
        
        function startWelcomeAnimation() {
            phaseStartTime = Date.now();
            createWelcomeText();
        }
        
        function createWelcomeText() {
            if (!this.font) return;
            
            const textGeometry = new THREE.TextGeometry('WELCOME', {
                font: this.font,
                size: 0.8,
                height: 0.2,
                curveSegments: 12,
                bevelEnabled: true,
                bevelThickness: 0.03,
                bevelSize: 0.02,
                bevelOffset: 0,
                bevelSegments: 5
            });
            
            textGeometry.center();
            
            const textMaterial = new THREE.MeshPhongMaterial({
                color: 0xff6b35,
                emissive: 0x331100,
                shininess: 100
            });
            
            welcomeText = new THREE.Mesh(textGeometry, textMaterial);
            scene.add(welcomeText);
            
            // Start phase transition after 3 seconds
            setTimeout(() => {
                transitionToPhase2();
            }, 3000);
        }
        
        function transitionToPhase2() {
            currentPhase = 2;
            phaseStartTime = Date.now();
            
            if (welcomeText) {
                // Fade out welcome text
                welcomeText.visible = false;
                scene.remove(welcomeText);
            }
            
            // Create letter spheres from "WELCOME" text
            const letters = 'WELCOME'.split('');
            const letterPositions = [];
            
            // Calculate positions for each letter
            for (let i = 0; i < letters.length; i++) {
                const angle = (i / letters.length) * Math.PI * 2;
                const x = Math.cos(angle) * 2;
                const y = Math.sin(angle) * 2;
                letterPositions.push(new THREE.Vector3(x, y, 0));
            }
            
            // Create glowing spheres for each letter
            letters.forEach((letter, index) => {
                const sphereGeometry = new THREE.SphereGeometry(0.15, 16, 16);
                const sphereMaterial = new THREE.MeshPhongMaterial({
                    color: 0xff6b35,
                    emissive: 0x331100,
                    shininess: 100
                });
                
                const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);
                sphere.position.copy(letterPositions[index]);
                sphere.userData = { letter, originalPosition: letterPositions[index] };
                scene.add(sphere);
                letterSpheres.push(sphere);
            });
            
            // Transition to vertical layout after 1 second
            setTimeout(() => {
                transitionToPhase3();
            }, 1000);
        }
        
        function transitionToPhase3() {
            currentPhase = 3;
            phaseStartTime = Date.now();
            
            // Arrange spheres in horizontal line
            const spacing = 0.8;
            const startX = -((letterSpheres.length - 1) * spacing) / 2;
            
            letterSpheres.forEach((sphere, index) => {
                const targetX = startX + (index * spacing);
                sphere.userData.targetPosition = new THREE.Vector3(targetX, 0, 0);
            });
            
            // Transition to interactive phase after 2 seconds
            setTimeout(() => {
                transitionToPhase4();
            }, 2000);
        }
        
        function transitionToPhase4() {
            currentPhase = 4;
            phaseStartTime = Date.now();
            
            // Convert letter spheres to interactive spheres
            interactiveSpheres = [...letterSpheres];
            letterSpheres = [];
            
            console.log('Interactive phase started - spheres are ready for interaction!');
        }
        
        function onMouseMove(event) {
            if (currentPhase < 4) return;
            
            const mouse = new THREE.Vector2();
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = - (event.clientY / window.innerHeight) * 2 + 1;
            
            const raycaster = new THREE.Raycaster();
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(interactiveSpheres);
            
            document.body.style.cursor = intersects.length > 0 ? 'pointer' : 'default';
        }
        
        function onClick(event) {
            if (currentPhase < 4) return;
            
            const mouse = new THREE.Vector2();
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = - (event.clientY / window.innerHeight) * 2 + 1;
            
            const raycaster = new THREE.Raycaster();
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(interactiveSpheres);
            
            if (intersects.length > 0) {
                const clickedSphere = intersects[0].object;
                createGlowingCard(clickedSphere);
                
                // Open portfolio link
                setTimeout(() => {
                    window.open(portfolioURL, '_blank');
                }, 500);
            }
        }
        
        function createGlowingCard(clickedSphere) {
            // Create large glowing sphere animation
            const largeSphereGeometry = new THREE.SphereGeometry(0.3, 16, 16);
            const largeSphereMaterial = new THREE.MeshPhongMaterial({
                color: 0xff6b35,
                emissive: 0x331100,
                shininess: 100
            });
            
            const largeSphere = new THREE.Mesh(largeSphereGeometry, largeSphereMaterial);
            largeSphere.position.copy(clickedSphere.position);
            scene.add(largeSphere);
            
            // Animate sphere growth
            const startScale = 0.1;
            const endScale = 1.0;
            const duration = 1000;
            const startTime = Date.now();
            
            function animateSphereGrowth() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                const scale = startScale + (endScale - startScale) * progress;
                largeSphere.scale.setScalar(scale);
                
                // Add pulsing effect
                largeSphere.rotation.y += 0.1;
                
                if (progress < 1) {
                    requestAnimationFrame(animateSphereGrowth);
                } else {
                    // Transform into card
                    transformToCard(largeSphere);
                }
            }
            
            animateSphereGrowth();
        }
        
        function transformToCard(sphere) {
            // Remove sphere
            scene.remove(sphere);
            
            // Create card data (cycle through available cards)
            const cardIndex = Math.floor(Math.random() * cardData.length);
            const card = cardData[cardIndex];
            
            // Create card geometry
            const cardGeometry = new THREE.BoxGeometry(1, 1, 0.1);
            
            // Create card texture
            const canvas = document.createElement('canvas');
            canvas.width = 256;
            canvas.height = 256;
            const ctx = canvas.getContext('2d');
            
            // Background
            ctx.fillStyle = '#2a2a2a';
            ctx.fillRect(0, 0, 256, 256);
            
            // Border
            ctx.strokeStyle = '#ff6b35';
            ctx.lineWidth = 4;
            ctx.strokeRect(2, 2, 252, 252);
            
            // Image/icon
            ctx.font = '80px Arial';
            ctx.textAlign = 'center';
            ctx.fillStyle = '#ff6b35';
            ctx.fillText(card.image, 128, 120);
            
            // Title
            ctx.font = 'bold 20px Arial';
            ctx.fillStyle = '#ffffff';
            ctx.fillText(card.title, 128, 180);
            
            // Description
            ctx.font = '14px Arial';
            ctx.fillStyle = '#cccccc';
            ctx.fillText(card.description, 128, 200);
            
            const texture = new THREE.CanvasTexture(canvas);
            
            const cardMaterial = new THREE.MeshBasicMaterial({
                map: texture,
                transparent: true
            });
            
            const cardMesh = new THREE.Mesh(cardGeometry, cardMaterial);
            cardMesh.position.copy(sphere.position);
            cardMesh.userData = card;
            scene.add(cardMesh);
            
            // Create info panel
            const panel = document.createElement('div');
            panel.id = card.name;
            panel.className = 'info-panel';
            panel.innerHTML = `
                <strong>${card.title}</strong><br>
                <p>${card.description}</p>
                <a href="${portfolioURL}" target="_blank">View Portfolio ‚Üí</a>
            `;
            document.body.appendChild(panel);
            
            // Show panel at click position
            const rect = renderer.domElement.getBoundingClientRect();
            panel.style.display = 'block';
            panel.style.left = (event.clientX) + 'px';
            panel.style.top = (event.clientY - 50) + 'px';
            
            // Remove card and sphere after 3 seconds
            setTimeout(() => {
                scene.remove(cardMesh);
                document.body.removeChild(panel);
            }, 3000);
        }
        
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
        
        function animate() {
            requestAnimationFrame(animate);
            
            const deltaTime = animationClock.getDelta();
            const elapsed = Date.now() - phaseStartTime;
            
            switch (currentPhase) {
                case 1:
                    // Welcome text animation
                    if (welcomeText) {
                        welcomeText.rotation.y += deltaTime * 0.5;
                        welcomeText.rotation.x += deltaTime * 0.2;
                    }
                    break;
                    
                case 2:
                    // Letter transformation animation
                    letterSpheres.forEach((sphere, index) => {
                        sphere.rotation.y += deltaTime * 2;
                        sphere.scale.setScalar(1 + Math.sin(Date.now() * 0.003 + index) * 0.2);
                    });
                    break;
                    
                case 3:
                    // Vertical arrangement animation
                    letterSpheres.forEach(sphere => {
                        if (sphere.userData.targetPosition) {
                            sphere.position.lerp(sphere.userData.targetPosition, deltaTime * 2);
                        }
                        sphere.rotation.y += deltaTime;
                    });
                    break;
                    
                case 4:
                    // Interactive phase - floating animation (horizontal)
                    interactiveSpheres.forEach((sphere, index) => {
                        const time = Date.now() * 0.001;
                        sphere.position.x = sphere.userData.targetPosition.x + Math.sin(time + index) * 0.1;
                        sphere.rotation.y += deltaTime * 0.5;
                    });
                    break;
            }
            
            renderer.render(scene, camera);
        }
        
        // Initialize when page loads
        window.addEventListener('load', init);
    </script>
</body>
</html>
